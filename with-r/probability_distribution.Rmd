---
title: "확률분포"
---

### 확률분포

- 함수명 규칙(함수명앞에붙는 분류)
  - 확률밀도함수 : d
  - 분위수함수 : q
  - 누적분포함수 : p
  - 난수발생함수 : r

- 관련함수
  - 이항분포 - dbinom, qbinom, pbinom, rbinom
  - 초기하분포 - dhyper, qhyper, phyper, rhyper
  - 포아송분포 - dpois, qpois, ppois, rpois
  - 카이제곱분포 - dchisq, qchisq, pchisq, rchisq
  - 정규분포 - dnorm, qnorm, pnorm, rnorm
  - F분포 - df, qf, pf, rf
  

#### 이항분포

**베르누이 시행(Bernoulli trial)**\
이항분포는 실험의 모든 가능한 결과가 두가지로 나오고 이실험이 반복했을때를 베르누이 시행이라고 한다.  
두가지 결과의 예는 {찬성, 반대}, {성공, 실패}, {양호품, 불량품}, {앞면, 뒷면}등의 형태이고 이 두가지 결과를 { 1, 0 }으로 대응 시키는 확률변수를 이항분포(binomial distribution)또는 베르누이 분포라고도 한다.\
$$ 베르누이 분포 : P(X=x)=p^x(1-p)^{1-x}, x=0,1$$

**이항분포(binomial distribution)**\
성공확률이 $p$인 베르누이 실험을 $n$번 독립적으로 반복 시행할 때, '성공횟수 $X$'가 $x$일 확률은 다음과 같다.
$$P(X=x)= {n\choose x}p^x(1-p)^{n-x}, x=0,1,2, ..., n $$
이항분포의 평균은 $E(X)=np$이고, 분산은 $Var(X)=np(1-p)$이다.

**샘플**\
어느 식당의 아침 메뉴중 과거의 경험으로 보아 라면을 주문할 확률이 20%이다. 오늘 아침 10명이 손님이 온다고 가정할때  
1. 3명의 손님이 라면을 주문할 확률  
2. 2명 이상이 라면을 주문할 확률  
3. 평균 몇명이 라면을 주문하겠는가? 또 그 표준 편차는?  
```{r}
# 1. 10명중 3명의 손님이 라면을 주문할 확률(라면 주문 확률은 0.2다)
dbinom(3, 10, 0.2)
# 2. 10명중 2명 이상의 손님이 라면을 주문할 확률
1-pbinom(1,10,0.2 )
# 평균 E(X)=np 이고, 분산은 np(1-p) : n = 10, p=0.2
n = 10
p = 0.2
(r.mean = n*p)
(r.var = n*p *(1-p))
```
**샘플2**\
담청률이 30%인 복권을 8장 구입.\
1. 4장이 당첨할 확률  
2. 3장에서 7장이 당첨할 확률  
3. 6장 이상이 당첨할 확률  
```{r}
# 1. 4장이 당첨할 확률
(dbinom(4, 8, 0.3))

# 2. 3장에서 7장이 당첨할 확률 : P( 3 <= X <= 7) = P(X<=7) - P(X<=2),
# P(X>=3) 부터이기 때문에 3이 포함되지 않는 P(X<=2)를 빼줘야 한다.
(pbinom(7, 8, 0.3) - pbinom(2, 8, 0.3))

# 3. 6장 이상이 당첨할 확률 P(X>=6) = 1 - P(X<=5)
(1-pbinom(5, 8, 0.3))
# 소숫점 5자리에서 반올림해서 4자리 까지만 출력
(round(1-pbinom(5, 8, 0.3),4)) 
# 소숫점 5자리에서 5를 뺀 후 round로 반올림을 해주면 절삭된 처리가 된다.
(round(1-pbinom(5, 8, 0.3)-0.00005,4)) 
```

**초기하분포(hypergeometric distribution)**  \n

`이항분포`는 성공확률이 $p$인 베르누이 실험을 $n$번 독립적으로 반복 시행할 때, '성공횟수 $X$'가 $x$일 확률이 일정하기 때문에 복원추출에 해당한다. 하지만 `초기하분포`는 비복원추출에 해당되기 때문에 매 시행마다 앞의 시행에 영향을 받아 성공 확률이 변한다.
주로 주머니에 흰색 탁구공이 m개, 주황색 탁구공이 n개 들어있을 때,  임의로 k개를 비복원 추출로 꺼내는 경우의 확률은 초기하분포를 따른다.
$$ P(X=x)= \frac{{D\choose x}{{N-D}\choose{n-x}}}{{N\choose n}}, x=1,2,...,n \\
  E(X)=np, (단, p=\frac{D}{N})\\Var(X)=np(1-p)\frac{N-n}{N-1}
$$

**샘플**\
주머니에 흰색 탁구공이 2개, 주황색 탁구공이 3개 들어있는 주머니에서 임의의 2개를 꺼냈을 때,  
$X$를 흰색 탁구공의 개수인 확률변수라고 할때, $X=0,1,2$의 값을 취할 확률은?  

```{r}
# x = 0, D = 2, N-D = 3, n = 2
dhyper(0, 2, 3, 2)

# x = 1, D = 2, N-D = 3, n = 2
dhyper(1, 2, 3, 2)

# x = 2, D = 2, N-D = 3, n = 2
dhyper(2, 2, 3, 2)

# 평균 E(X) = n*p, p = D/N
p=2/5
2*p # 평균
#분산 Var(X) = np(1-p)*(N-n)/(N-1)
2*p*(1-p)*(5-2)/(5-1) #분산
```

**포아송분포**\
매우희귀하게 발생하는 사건의 수를 확률변수로 정의할 때, 확률분포로 이용된다.\
1. 독립성 : 한 단위시간이나 공간에서 출현하는 성공횟수와 중복되지 않는 다른 단위시간이나 공간에서 출현하는 성공횟수는 서로 독립이다.\
2. 비집락성 : 극희 작은 시간이나 공간에서 둘 이상의 성공이 같이 일어날 확률은 매우 작으면 0으로 간주한다.\
3. 비례성 : 단위시간이나 공간에서 성공의 평균출현횟수는 일정하며, 이는 시간이나 공간에 따라 변하지 않는다.\
$$P(X=x)=\frac{e^{-m}m^x}{x!},\ \ \ \  x=0,1,2,... \\
평균: E(X)=m, \ \ \ \ 분산:Var(X)=m$$

**샘플**\
1860명의 자동차보험 계약자중 1년에 사고가 발생하여 청구할 확률이 1/600이다. 보험금 청구 횟수를 $X$라고 할때 x=0,1,2,3인 확률 구하기 (평균 $m=n*p=1860 * (1/600)$)

```{r}
# m = n * p이다. (n=1860, p=1/600)
n=1860
p=1/600
(m = n*p) #평균 3.1이된다.
# x=0
(round(dpois(0, m),4))
# x=1
(round(dpois(1, m),4))
# x=2
(round(dpois(2, m),4))
# x=3
(round(dpois(3, m),4))

```
**샘플2**\
인터넷 쇼핑몰 상점에서 반품을 하루 평균 6번 받게된다고 할때, 오늘 반품을 4번 받을 확률은?
```{r}
m=6
x=4
(round(dpois(x, m),4))
# 반품을 1번에서 13번까지 받을 분포표
plot(dpois(x=1:13,m), type='h', main = "Poisson distribution, lambda = 6")
```

**정규분포(normal distribution)**\
정규분포는 대표적인 연속확률분포이다.  
확률변수 $X$가 평균 $\mu$, 표준편차$\sigma$인 정규분포를 따를때 $X\sim N(\mu,\sigma^2)$으로 표시한다.

**정규분포함수(normal distribution function)**\
$$f(x)=\frac{1}{\sqrt{2\pi} \sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}, \ -\infty < x < \infty$$
**정규분포의 표준화 변환**\
$X$가 평균이 $\mu$이고 분산이 $\sigma^2$인 정규분포표 $N(\mu,\sigma^2)$일때 변환
$$Z=\frac{X-\mu}{\sigma}$$
는 평균이 0이고 표준편차가 1인 표준정규분포 $N(0,1)$을 따른다.

**샘플1**\
$Z$가 표준정규확률변수 일때, 다음 확률을 구하여라.
```{r}
# 1. P(Z < 1.96)
round(pnorm(1.96), 3)
# 2. P(-1.96 < Z < 1.96)
round(pnorm(1.96),3) - round(pnorm(-1.96), 3)
#3. p(Z > 1.96) = 1 - P(Z < 1.96)
1-round(pnorm(1.96), 3)
```

**정규분포의 확률계산**\
$X$가 평균이 $\mu$, 분산이 $\sigma^2$인 정규분포변수라면 $P(a < X < b)$는 다음과 같다.
$$P(a < X < b) = P(\frac{a-\mu}{\sigma} < Z < \frac{b-\mu}{\sigma})$$
**샘플**\
확률변수 $X$가 평균이 70, 표준편차가 10인 정규분포를 따를 때 다음의 확률을 구하라
```{r}
# 1. P(X < 94.3)
round(pnorm(94.3, 70, 10), 4) # 정규분포 함수 이용
round(pnorm(round((94.3-70)/10, 4)), 4) # 정규분포의 표준화변환을 이용
# 2. P(X > 57.7)
1- round(pnorm(57.7, 70, 10), 4) # 정규분포 함수 이용
1- round(pnorm(round((57.7-70)/10, 4)), 4) # 정규분포의 표준화변환을 이용
# 3. P(57.7 < X < 94.3)
# 실제 R프로그램에서는 0.0001의 오차가 발생하여 0.8832값이 출력된다.
round(pnorm(94.3, 70, 10), 4) - round(pnorm(57.7, 70, 10), 4) # 정규분포 함수 이용
round(pnorm(round((94.3-70)/10, 4)), 4) - round(pnorm(round((57.7-70)/10, 4)), 4) # 정규분포의 표준화변환을 이용

```
**샘플2**\
한 회사의 배터리 평균 수명이 110, 표준편차가 10인 정규분포를 따른다.
```{r}
# 정규분포의 표준화 변환을 이용해서 함수 적용
# 1. P(X < 90)
round(pnorm(round((90-110)/10, 4)), 4) # 정규분포의 표준화변환을 이용
# 2. P( 100 < X < 115)
round(pnorm(round((115-110)/10, 4)), 4) - 
  round(pnorm(round((100-110)/10, 4)), 4) 
# 3. P(120 < X)
1- round(pnorm(round((120-110)/10, 4)), 4) 


```

**표본분포**\
표본으로 모집단의 성질을 이끌어내는 과정을 `통계적 추론(statistical inference)`이라고 한다.\
모집단의 특성값을 `모수(parameter)`라고 한다.\
표본으로부터 계산되는 함수식을 `통계량(statistics)`이라고 한다.\
통계량은 일정하지 않고 표본이 달라지면 다른 값을 갖게되는데 이 값을 확률변수로서 확률분포를 가지며 통계량의 분포를 `표본분포(표집분포,sampling distribution)`라고 한다.\
표본평균은 모평균의 비편향추정량(unbiased estimator)이다.


**샘플**\
모집단 { 6,2,4,8,10 } 일때
```{r}
# 1. 평균과 분산
x<-c(6,2,4,8,10)

# 2. 표본 2개를 뽑았을때의 표본평균과 표본분산

# 조합을 만들기 위해서 5 x 5 행렬을 만든다.
mat<-matrix(data = 0, nrow = 5, ncol=5)
# 가로배열과 세로배열로 더해주면 표본 2개를 더해서 만든 원소의 행렬이 만들어진다.
for (i in 1:5)
{
  mat[i,]= mat[i,] + x
  mat[,i]= mat[,i] + t(x)
}
# 각각의 원소들끼리의 평균을 구한다.
(mat<-mat/2) # 원소는 (Xi + xj) / 2
# 빈도수를 추출한다.
(dat = table(mat))
# 상대도수
(dat.prop = prop.table(dat))
# 누적적상대도수
(dat.cumprop = cumsum(dat.prop))

plot(dat, main="표본평균분포", xlab="평균", ylab="도수")

```
$$  s = \sqrt{s^2 } = \sqrt{ { 1 \over n-1 } \sum_{i=1}^n  (X_i - \bar{X})^2  }  $$
모평균$\mu$와 모분산 $\sigma^2$을 갖는 모집단에서 추출한 랜덤 표본을 $X_1, X_2, ..., X_n$이라고 하면
$$\overline{X}=\frac{1}{n}(X_1 + X_2 + ... + X_n)$$
기대값은 $E(\overline{X})=\mu$이고 분산은 $Var(\overline{X})=\sigma^2/n$이 된다.


**표본분산의분포**\
모집단의 모분산과 표본에서 얻어지는 표본분산 사이의 관계\
모집단이 모분산 $\sigma^2$인 정규분포를 따를 때 크기가 n인 표본을 랜덤 추출하면 $(n-1)S^2/\sigma^2$은 자유도가 $(n-1)$인 $\chi^2$분포를 따른다.
$$(n-1)S^2/\sigma^2 \sim \chi^2(n-1)$$
여기서 $S^2=\frac{\sum_{i=1}^n(X_i - \overline{X})^2}{n-1}$이다.


**중심극한의 정리(central limit theorem)**\
평균이 $\mu$이고, 분산이 $\sigma^2$인 임의의 무한모집단에서 표본크기($n$)가 충분히 크면, 표본평균 $\overline{X}$의 분포는 근사적으로 평균이 $\mu$이고, 분산이 $\frac{\sigma^2}{n}$인 정규분포를 따른다.

**예제4-10**\
생산되는 제품의 불량률이 5%인 한 공장에서 어느날 제품 100개를 표본추출했다고 하자.\
(1)불량품이 2개 이하일 확률은?\
(2)3개에서 7개일 확률은?\
```{r}
# 불량품의 개수를 X라고 하면 X는 n=100, p=0.05인 이항붙포이다. 이렇게 n이 큰 경우 정규분포를 이용하여 근사적으로 확률을 계산한다. 
n = 100; p = 0.05
(m = n * p)
(s = sqrt(n * p * (1 - p)))
# 표준정규분포는 (x - m)/s ~ N(0, 1)
(pnorm((2-m)/s))
# (1)불량품이 2개 이하일 확률은? 평균 m, 표준편차 s인 정규분포
(pnorm(2, m, s))
# (2)3개에서 7개일 확률은?
(pnorm(7, m, s)- pnorm(3, m, s))
```
**t분포**\
정규분포 $N(\mu,\sigma^2)$을 따르는 모집단으로부터 $X_1, ..., Xn$의 확률표본을 얻었을때, $\overline{X} \sim N(\mu, \frac{\sigma^2}{n})$이며, 이를 표준화한 식은 정규분포를 따른다.
$$\frac{\overline{X}-\mu}{\sigma/\sqrt{n}} \sim N(0,1)$$
그런데 모분산 $\sigma^2$을 알기 어려우므로 모분산 $\sigma^2$를 표본분산 $S^2$으로 대치한다.\
모 표준편차 $\sigma$를 표본 표준편차$S$로 대치한 식의 분포가 자유도(df) $n-1$의 *t*분포임을 밝혔다.
$$\frac{\overline{X}-\mu}{S/\sqrt{n}} \sim t_{n-1}, \ \ S=\sqrt{\frac{1}{n-1}\sum_{i=1}^n(X_i-\overline{X})^2}$$
  
**예제4-11**\
영업사원 5명의 근무연수를 모집단 { 6, 2, 4, 8, 10 } 표본크기가 2인 모든 가능한 표본을 랜덤 복원 추출하여 각각의 표본분산을 구하고, 표본의 분산과 표본분산 전체의 평균을 구하고 모집단의 분산과 비교하라
```{r}
# 모집단 정의
population = c(6, 2, 4, 8, 10)

# 표본크기가 2인 모든 가능한 표본 생성
(df<-data.frame())
for(x in population)
{
  for(y in population)
  {
      df <- rbind(df, c(x,y))
  }
}
# 컬럼명을 변경
colnames(df)<-c("x1", "x2")
# 각 표본의 평균을 생성하고
df$mean = (df$x1 + df$x2)/2
# 각 표본의 분산을 생성한다.
df$var = (df$x1 - df$mean)^2 + (df$x2 - df$mean)^2 
# 표본 분산의 평균을 구한다.
sample.var.mean = mean(df$var)
# 모집단의 분산을 구한다.
# var() 함수는 표본의 분산을 구하는 함수 이므로 n / (n -1)이 된 상태이다.
# 모집단의 분산을 구하기 위해서는 var() * (n-1) / n을 해줘야 한다.
(population.var = var(population) * (length(population)-1)/length(population))
#모집단의 분산과 표본분산의 평균 
(c(population.var,sample.var.mean ))
# 표본 분산의 돗수를 구한다.
(sample.table = table(df$var))
# 표본 분산의 상대도수를 생성하고
(sample.prop = prop.table(sample.table))
# 표본 분산의 누적돗수분포를 생성한다.
(sample.cumsum=cumsum(sample.prop))

# 표분분산 도수분포 막대그래프
seq(0,32,by=2)
plot(sample.table,main="표본분산 도수분포 막대그래프", xlab="표본분산",ylab="표본분산의 도수" )
# barplot에서 X축의 도수를 늘리려면
```
**모분산 추정이 중요한 사례**\
어느 거리측정기 생산업체의 제품 정밀도 평가\
-. 측정거리의 편차가 크면 불량품으로 간주함\
-. 측정 거리의 모분산이 중요함\
어느 플라스틱판 생산 공장의 공정관리\
-. 판 두께의 표준편차가 1.5mm보다 크면 공정 이상으로 판단.\

**모분산, 모표준편차의 점추정**\
모분산($\sigma^2$)의 점추정량\
-. 표본분산$S^2 = \sum_{i=1}^n(X_i-\bar{X})^2/(n-1)$\
모표준편차의 점추정\
-. 표본표준편차$S = \sqrt{\sum_{i=1}^n(X_i-\bar{X})^2/(n-1)}$\

**표본분산의 분포**\
모분산 $\sigma^2$인 정규분포에서 뽑은 랜덤표본일때\
$\frac{(n-1)S^2}{\sigma^2} \sim \chi^2(n-1)$\
여기서, $S^2=\sum(X_i-\bar{X})^2/(n-1)$\
*통계량$(n-1)S^2/\sigma^2$은 여기서, 자유도 $n-1$인 카이제곱분포($\chi^2$ distribution)을 따른다.*

**F 분포 - 표본분산 비의 분포**\
F분포(F-distribution)는 정규분포를 따르는 두 모집단에서 독립적으로 추출한 표본들의 표본분산비의 확률분포이다. 

두 모집단이 각각 모분산 $\sigma_1^2$, $\sigma_2^2$인 정규분포를 따를때 이 두 모집단에서 독립적으로 추출한 크기 $n_1$개 및 $n_2$개인 표본의 분산을 각각$S_1^2, S_2^2$이라고 하면, 통계량 
$$F=\frac{(\frac{S_1^2}{\sigma_1^2})}{(\frac{S_2^2}{\sigma_2^2})} \sim F(n_1 -1, n_2-1)$$
은 *분자자유도 $n_1-1$, 분모자유도 $n_2-1$인 F분포를 따른다.*


### 연습문제

**문제-01**\
대학의 컴퓨터 실습실 PC의 수명은 평균이 3.25년 표준편차가 0.5년의 정규분포를 한다고 알려져 있다 25대를 조사하여 구한 수명이 3년 이하일 확률은?\
표본분포의 기대값과 분산은\
$E(\overline{X}) = \mu$이고 $Var(\overline{X})=\frac{\sigma^2}{n}$이므로\
$E(Z)=\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}$이다.
따라서 $P(X<=3)$는 정규분포의 표준화 변환을 하면 $P(Z<=(3-3.25)/(0.5/\sqrt{25}))$
```{r}
# 표준정규분포 N(0,1) 
pnorm((3-3.25)/(0.5/sqrt(25)), 0, 1)
# 또는 아래와 같이 평균과 표준편차를 계산하지 않고 사용
pnorm(3, 3.25, 0.5 / sqrt(25))
```


**문제-02**\
적성검사의 분포는 평균이 250점, 표준편차가 20점인 정규분포를 따른다고 한다. 적성검사 점수가 380인 학생의 표준점수는?\
정규분포의 표준화 변화를 이용하면 $X \sim N(\mu,\sigma^2)$일때, $Z=(X-\mu)/\sigma$가 된다.

```{r}
(380-250)/20
```


**문제-04**\
검은공 2개와 흰공 2개가 들어있는 항아리에서 공을 하나씩 꺼낸다. 매번 공을 색깔을 보고 다음공을 꺼내기 전에 같은색의 공을 꺼낸 공과 함께 되돌려 넣는 시행을 한다고 하자 두번째 공이 희공일 확률을 구하여라.\
1. 첫번째 시행 흰색일 경우는 두번째 시행에서는 흰공이 3개 검은공이 2개가 된다.\
$\frac{2}{4} * \frac{3}{5}$\
2. 첫번째 시행 검색일 경우는 두번째 시행에서는 흰공이 2개 검은공이 3개가 된다.\
$\frac{2}{4} * \frac{2}{5}$\

1인 경우와 2인경우를 모두 합치면 $\frac{2}{4} * \frac{3}{5}$ + $\frac{2}{4} * \frac{2}{5}$ = $\frac{1}{2}$

**문제-05**\
평균이 76이고 표준편차가 10인 정규분포가 주어졌다.\
1. 관측값이 71과 82 사이에 있을 확률\
2. 관측값이 75보다 클 확률\
3. 관측값이 78 미만일 확률\
```{r}
# 1. 관측값이 71과 82 사이에 있을 확률
pnorm(82, 76, 10) - pnorm(71, 76, 10)
# 2. 관측값이 75보다 클 확률\
1-pnorm(75, 76, 10)
# 3. 관측값이 78 미만일 확률\
pnorm(78, 76, 10)

```

**문제-06**\
큰 관공서에서 결근의 주된 원인은 1/9이 아픈 경우이다. 임의로 고른 4명의 결근자 중 3명이 아파서 결근할 확률을 구하라.\
이항분포의 확률을 구하는 문제\
$$P(X=x)={n\choose x}p^x(1-p)^{n-x}, \ \ x=0,1,2,...,n \\
E(X)=np, \ \ \ Var(X)=np(1-p)$$

```{r}
x=3;n=4;p=1/9
# combination은 choose 함수를 이용해서 구한다.
(round(choose(n,x)*p^x*(1-p)^(n-x),4))
round(dbinom(3, 4, 1/9),4)
```

**문제-07**\
프로야구 경기에서 연장전을 할 확률이 0.1이라고 할때, 다섯경기에서 적어도 한 경기가 연장전으로 이어질 확률을 이항분포를 적용하여 구하여라.\
p = 0.1, n=5, 적어도 한경기가 연장전으로 이이어질 확률은 한경기도 연장전으로 이어지지 않을 확률의 여사건이다.
1-P(X=0)
```{r}
round(1-dbinom(0, 5, 0.1),4)
```
**문제-08**\
한 시간에 평균 10번의 안내 요청 전화가 걸려오는 어느 여해사에서 안내원이 외출한 30분동안 네번 걸려올 확률과 한번도 걸려오지 않을 확률을 구하여라.\
포아송분포의 확률을 구한다.\
$$P(X=x)=\frac{e^{-m}m^x}{x!}, \ \ x=0,1,...\\
E(X)=m,\ \  Var(X)=m$$
한시간동안 10번, 30분동안 5번
```{r}
# 평균5일때 4회가 나올 확률
dpois(4, 5)

# 평균5일때 4회가 나올 확률
dpois(0, 5)
```
**문제-09**\
어느회사에서 휴일 다음날 결근하는 회원의 수는 평균 2.5명으로 포아송분포를 따른다고 한다.\
$$P(X=x)=\frac{e^{-m}m^x}{x!}, \ \ x=0,1,...\\
E(X)=m,\ \  Var(X)=m$$
1. 평균과 분산을 구하여라. ( 2.5, 2.5 )\
2. 어느 휴일 다음 날 5명이 결근할 확률을 구하여라 \
3. 어느 휴일 다음날 5명 이상이 결근할 확률을 구하여라 \
```{r}
# 2. 어느 휴일 다음 날 5명이 결근할 확률을 구하여라 \
dpois(5, 2.5)
# 3. 어느 휴일 다음날 5명 이상이 결근할 확률을 구하여라 
# 5명 이상이기 때문에 1에서 4명까지의 누적확률분포를 뺀다.
1-ppois(4,2.5)
```

**문제-10**\
도난경보기 100개중 4개는 불량품으로 제대로 작동하지 않는다 만일 경보기 3개를 골라서 손님에게 팔고 설치했을때, 불량경보기1개를 설치할 확률의 초기하분포 공식을 이용하여 구하여라.
$$P(X=x)=\frac{{D\choose x}{{N-D}\choose{n-x}}}{N\choose n}, \ \ x=0, 1, 2, ..., n \\
E(X)=np(단,p=\frac{D}{N}), \ \ Var(X)=np(1-p)\frac{N-n}{N-1}$$
```{r}
N = 100; D = 4; n = 3; x = 1
# 조합 공식을 사용하여 초기화분포의 확률을구함
choose(D,x)*choose(N-D, n-x)/choose(N, n)
# 초기와 확률 계산 함수를 이용
dhyper(x, D, N-D, n)
```
**문제-11**\
흰공 3개와 빨간 공 2개가 들어 있는 주머니에서 랜덤하게 2개를 취했을 때 빨간 공의 개수를 X라고 하자. X의 평균과 분산을 계산하라.\
```{r}
N = 5; D = 2; n = 2; p = D/N
# 평균
(m = n*p)
# 분산
(variance = n*p*(1-p)*(N-n)/(N-1))
```

**문제-12**\
모평균이 $\mu$, 모분산이 $\sigma^2$인 임의의 무한모집단에서 표본을 추출하여 확률변수 $X$를 관측할 때 표본크기$(n)$가 충분히 크면 표본평균은 중심극한정리에 의하여 정규분포로 수렴된다. 이때 정규분포의 형태는 $$N(\mu, \frac{\sigma^2}{n})$$

**문제-13**\
이항분포$B(n,p)$를 따르는 $X$는 $n$이 충분히 클때 근사적으로 $N(np, np(n-p))$ 를 따른다.

**문제-14**\
모분산 $\sigma^2$인 정규모집단에서 표본을 추출할 때 표본의 크기가(n)가 충분이 크면 $\frac{(n-1)S^2}{\sigma^2}$은 어떤 분포를 따르는가? 단 $S^2=\frac{1}{n-1}\sum_{i=1}^n(X_i-\overline{X})^2$ \
$$ \chi^2(n-1)$$

**문제-15**\
100원짜리 동전 2개를 던지는 시행을 1,200회 하여 2의 모두 앞면이 나온 횟수를 $X$라고 할 때, 확률 $P(285\le X \le 315)$ 값을 구하면?\
이항분포의 정규근사를 이용한다.
$$B(n, p) \sim N(np, np(1-p)),\ \ \  E(X)=np,\ \ \ Var(X)=np(1-p)  \\
\frac{X-np}{\sqrt{np(1-p)}} \sim N(0,1)$$

```{r}
n = 1200; p = 1/4;
exp = n*p
var = n*p*(1-p)
# 표준정규분포
pnorm((315-exp)/sqrt(var),0,1)-pnorm((285-exp)/sqrt(var),0,1)
# 정규분포
pnorm(315, exp, sqrt(var))-pnorm(285, exp, sqrt(var))

```

