---
title: "확률분포"
---

### 확률분포

- 함수명 규칙(함수명앞에붙는 분류)
  - 확률밀도함수 : d
  - 분위수함수 : q
  - 누적분포함수 : p
  - 난수발생함수 : r

- 관련함수
  - 이항분포 - dbinom, qbinom, pbinom, rbinom
  - 초기하분포 - dhyper, qhyper, phyper, rhyper
  - 포아송분포 - dpois, qpois, ppois, rpois

#### 이항분포

**베르누이 시행(Bernoulli trial)**\
이항분포는 실험의 모든 가능한 결과가 두가지로 나오고 이실험이 반복했을때를 베르누이 시행이라고 한다.  
두가지 결과의 예는 {찬성, 반대}, {성공, 실패}, {양호품, 불량품}, {앞면, 뒷면}등의 형태이고 이 두가지 결과를 { 1, 0 }으로 대응 시키는 확률변수를 이항분포(binomial distribution)또는 베르누이 분포라고도 한다.\
$$ 베르누이 분포 : P(X=x)=p^x(1-p)^{1-x}, x=0,1$$

**이항분포(binomial distribution)**\
성공확률이 $p$인 베르누이 실험을 $n$번 독립적으로 반복 시행할 때, '성공횟수 $X$'가 $x$일 확률은 다음과 같다.
$$P(X=x)= {n\choose x}p^x(1-p)^{n-x}, x=0,1,2, ..., n $$
이항분포의 평균은 $E(X)=np$이고, 분산은 $Var(X)=np(1-p)$이다.

**샘플**\
어느 식당의 아침 메뉴중 과거의 경험으로 보아 라면을 주문할 확률이 20%이다. 오늘 아침 10명이 손님이 온다고 가정할때  
1. 3명의 손님이 라면을 주문할 확률  
2. 2명 이상이 라면을 주문할 확률  
3. 평균 몇명이 라면을 주문하겠는가? 또 그 표준 편차는?  
```{r}
# 1. 10명중 3명의 손님이 라면을 주문할 확률(라면 주문 확률은 0.2다)
dbinom(3, 10, 0.2)
# 2. 10명중 2명 이상의 손님이 라면을 주문할 확률
1-pbinom(1,10,0.2 )
# 평균 E(X)=np 이고, 분산은 np(1-p) : n = 10, p=0.2
n = 10
p = 0.2
(r.mean = n*p)
(r.var = n*p *(1-p))
```
**샘플2**\
담청률이 30%인 복권을 8장 구입.\
1. 4장이 당첨할 확률
2. 3장에서 7장이 당첨할 확률
3. 6장 이상이 당첨할 확률
```{r}
# 1. 4장이 당첨할 확률
(dbinom(4, 8, 0.3))

# 2. 3장에서 7장이 당첨할 확률 : P( 3 <= X <= 7) = P(X<=7) - P(X<=2),
# P(X>=3) 부터이기 때문에 3이 포함되지 않는 P(X<=2)를 빼줘야 한다.
(pbinom(7, 8, 0.3) - pbinom(2, 8, 0.3))

# 3. 6장 이상이 당첨할 확률 P(X>=6) = 1 - P(X<=5)
(1-pbinom(5, 8, 0.3))
# 소숫점 5자리에서 반올림해서 4자리 까지만 출력
(round(1-pbinom(5, 8, 0.3),4)) 
# 소숫점 5자리에서 5를 뺀 후 round로 반올림을 해주면 절삭된 처리가 된다.
(round(1-pbinom(5, 8, 0.3)-0.00005,4)) 
```

**초기하분포(hypergeometric distribution)**  \n

`이항분포`는 성공확률이 $p$인 베르누이 실험을 $n$번 독립적으로 반복 시행할 때, '성공횟수 $X$'가 $x$일 확률이 일정하기 때문에 복원추출에 해당한다. 하지만 `초기하분포`는 비복원추출에 해당되기 때문에 매 시행마다 앞의 시행에 영향을 받아 성공 확률이 변한다.
주로 주머니에 흰색 탁구공이 m개, 주황색 탁구공이 n개 들어있을 때,  임의로 k개를 비복원 추출로 꺼내는 경우의 확률은 초기하분포를 따른다.
$$ P(X=x)= \frac{{D\choose x}{{N-D}\choose{n-x}}}{{N\choose n}}, x=1,2,...,n \\
  E(X)=np, (단, p=\frac{D}{N})\\Var(X)=np(1-p)\frac{N-n}{N-1}
$$

**샘플**\
주머니에 흰색 탁구공이 2개, 주황색 탁구공이 3개 들어있는 주머니에서 임의의 2개를 꺼냈을 때,  
$X$를 흰색 탁구공의 개수인 확률변수라고 할때, $X=0,1,2$의 값을 취할 확률은?  

```{r}
# x = 0, D = 2, N-D = 3, n = 2
dhyper(0, 2, 3, 2)

# x = 1, D = 2, N-D = 3, n = 2
dhyper(1, 2, 3, 2)

# x = 2, D = 2, N-D = 3, n = 2
dhyper(2, 2, 3, 2)

# 평균 E(X) = n*p, p = D/N
p=2/5
2*p # 평균
#분산 Var(X) = np(1-p)*(N-n)/(N-1)
2*p*(1-p)*(5-2)/(5-1) #분산
```

**포아송분포**\
매우희귀하게 발생하는 사건의 수를 확률변수로 정의할 때, 확률분포로 이용된다.
1. 독립성 : 한 단위시간이나 공간에서 출현하는 성공횟수와 중복되지 않는 다른 단위시간이나 공간에서 출현하는 성공횟수는 서로 독립이다.
2. 비집락성 : 극희 작은 시간이나 공간에서 둘 이상의 성공이 같이 일어날 확률은 매우 작으면 0으로 간주한다.
3. 비례성 : 단위시간이나 공간에서 성공의 평균출현횟수는 일정하며, 이는 시간이나 공간에 따라 변하지 않는다.
$$P(X=x)=\frac{e^{-m}m^x}{x!},\ \ \ \  x=0,1,2,... \\
평균: E(X)=m, \ \ \ \ 분산:Var(X)=m$$

**샘플**\
1860명의 자동차보험 계약자중 1년에 사고가 발생하여 청구할 확률이 1/600이다. 보험금 청구 횟수를 $X$라고 할때 x=0,1,2,3인 확률 구하기 (평균 $m=n*p=1860 * (1/600)$)

```{r}
# m = n * p이다. (n=1860, p=1/600)
n=1860
p=1/600
(m = n*p) #평균 3.1이된다.
# x=0
(round(dpois(0, m),4))
# x=1
(round(dpois(1, m),4))
# x=2
(round(dpois(2, m),4))
# x=3
(round(dpois(3, m),4))

```
**샘플2**\
인터넷 쇼핑몰 상점에서 반품을 하루 평균 6번 받게된다고 할때, 오늘 반품을 4번 받을 확률은?
```{r}
m=6
x=4
(round(dpois(x, m),4))
# 반품을 1번에서 13번까지 받을 분포표
plot(dpois(x=1:13,m), type='h', main = "Poisson distribution, lambda = 6")
```

**정규분포(normal distribution)**\
정규분포는 대표적인 연속확률분포이다.  
확률변수 $X$가 평균 $\mu$, 표준편차$\sigma$인 정규분포를 따를때 $X\sim N(\mu,\sigma^2)$으로 표시한다.

**정규분포함수(normal distribution function)**\
$$f(x)=\frac{1}{\sqrt{2\pi} \sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}, \ -\infty < x < \infty$$
**정규분포의 표준화 변환**\
$X$가 평균이 $\mu$이고 분산이 $\sigma^2$인 정규분포표 $N(\mu,\sigma^2)$일때 변환
$$Z=\frac{X-\mu}{\sigma}$$
는 평균이 0이고 표준편차가 1인 표준정규분포 $N(0,1)$을 따른다.

**샘플1**\
$Z$가 표준정규확률변수 일때, 다음 확률을 구하여라.
```{r}
# 1. P(Z < 1.96)
round(pnorm(1.96), 3)
# 2. P(-1.96 < Z < 1.96)
round(pnorm(1.96),3) - round(pnorm(-1.96), 3)
#3. p(Z > 1.96) = 1 - P(Z < 1.96)
1-round(pnorm(1.96), 3)
```

**정규분포의 확률계산**\
$X$가 평균이 $\mu$, 분산이 $\sigma^2$인 정규분포변수라면 $P(a < X < b)$는 다음과 같다.
$$P(a < X < b) = P(\frac{a-\mu}{\sigma} < Z < \frac{b-\mu}{\sigma})$$
**샘플**\
확률변수 $X$가 평균이 70, 표준편차가 10인 정규분포를 따를 때 다음의 확률을 구하라
```{r}
# 1. P(X < 94.3)
round(pnorm(94.3, 70, 10), 4) # 정규분포 함수 이용
round(pnorm(round((94.3-70)/10, 4)), 4) # 정규분포의 표준화변환을 이용
# 2. P(X > 57.7)
1- round(pnorm(57.7, 70, 10), 4) # 정규분포 함수 이용
1- round(pnorm(round((57.7-70)/10, 4)), 4) # 정규분포의 표준화변환을 이용
# 3. P(57.7 < X < 94.3)
# 실제 R프로그램에서는 0.0001의 오차가 발생하여 0.8832값이 출력된다.
round(pnorm(94.3, 70, 10), 4) - round(pnorm(57.7, 70, 10), 4) # 정규분포 함수 이용
round(pnorm(round((94.3-70)/10, 4)), 4) - round(pnorm(round((57.7-70)/10, 4)), 4) # 정규분포의 표준화변환을 이용

```
**샘플2**\
한 회사의 배터리 평균 수명이 110, 표준편차가 10인 정규분포를 따른다.
```{r}
# 정규분포의 표준화 변환을 이용해서 함수 적용
# 1. P(X < 90)
round(pnorm(round((90-110)/10, 4)), 4) # 정규분포의 표준화변환을 이용
# 2. P( 100 < X < 115)
round(pnorm(round((115-110)/10, 4)), 4) - 
  round(pnorm(round((100-110)/10, 4)), 4) 
# 3. P(120 < X)
1- round(pnorm(round((120-110)/10, 4)), 4) 


```

**표본분포**\
표본으로 모집단의 성질을 이끌어내는 과정을 `통계적 추론(statistical inference)`이라고 한다.\
모집단의 특성값을 `모수(parameter)`라고 한다.\
표본으로부터 계산되는 함수식을 `통계량(statistics)`이라고 한다.\
통계량은 일정하지 않고 다른 값을 갖게되는데 이 값을 확률변수로서 확률분포를 가지며 통계량의 분포를 `표본분포(표집분포,sampling distribution)`라고 한다.\
표본평균은 모평균의 비편향추정량(unbiased estimator)이다.


**샘플**\
모집단 { 6,2,4,8,10 } 일때
```{r}
# 1. 평균과 분산
x<-c(6,2,4,8,10)

# 2. 표본 2개를 뽑았을때의 표본평균과 표본분산

# 조합을 만들기 위해서 5 x 5 행렬을 만든다.
mat<-matrix(data = 0, nrow = 5, ncol=5)
# 가로배열과 세로배열로 더해주면 표본 2개를 더해서 만든 원소의 행렬이 만들어진다.
for (i in 1:5)
{
  mat[i,]= mat[i,] + x
  mat[,i]= mat[,i] + t(x)
}
# 각각의 원소들끼리의 평균을 구한다.
(mat<-mat/2) # 원소는 (Xi + xj) / 2
# 빈도수를 추출한다.
(dat = table(mat))
# 상대도수
(dat.prop = prop.table(dat))
# 누작상대도수
(dat.cumprop = cumsum(dat.prop))

plot(dat, main="표본평균분포", xlab="평균", ylab="도수")

```
$$  s = \sqrt{s^2 } = \sqrt{ { 1 \over n-1 } \sum_{i=1}^n  (X_i - \bar{X})^2  }  $$
모평균$\mu$와 모분산 $\sigma^2$을 갖는 모집단에서 추출한 랜덤 표본을 $X_1, X_2, ..., X_n$이라고 하면
$$\overline{X}=\frac{1}{n}(X_1 + X_2 + ... + X_n)$$
기대값은 $E(\overline{X})=\mu$이고 분산은 $Var(\overline{X})=\sigma^2/n$이 된다.

**중심극한의 정리(central limit theorem)**\
평균이 $\mu$이고, 분산이 $\sigma^2$인 임의의 무한모집단에서 표본크기($n$)가 충분히 크면, 표본평균 $\overline{X}$의 분포는 근사적으로 평균이 $\mu$이고, 분산이 $\frac{\sigma^2}{n}$인 정규분포를 따른다.
